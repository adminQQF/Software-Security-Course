该实验主要针对PE文件格式分析，包括：

## 2.1实验名称

PE文件格式分析

## 2.2实验目的

1、熟悉各种PE编辑查看工具，详细了解PE文件格式
2、重点分析PE文件文件头、引入表、引出表，以及资源表
3、自己打造一个尽可能小的PE文件
2.3实验步骤及内容

**第一阶段：PE文件格式分析**
- 使用UltraEdit观察PE文件例子程序hello-2.5.exe的16进制数据，在打印稿中画出该PE文件基本结构。
- 使用Ollydbg对该程序进行初步调试，了解该程序功能结构，在内存中观察该程序的完整结构。
- 熟悉各类PE文件格式查看和编辑工具（PEView、Stud_PE等）。
- 使用UltraEdit修改该程序，使得该程序仅弹出第二个对话框。

**第二阶段：熟悉并分析PE文件的引出表**
- 找到系统System32目录下的user32.dll文件，用UltraEdit打开并分析该文件引出表，找出函数MessageBoxA的地址，并验证该地址是否正确。

**第三阶段：熟悉并修改PE文件的引入表结构，以及代码段和数据段**
- 手工修改hello-2.5.exe程序，使得其可以弹出第三个对话框。
- 用UltraEdit修改hello-2.5.exe程序的引入表，使该程序仅可以从kernel32.dll中引入LoadLibrary和GetProcAddress函数，而不从user32.dll导入任何函数。然后，在代码节中写入部分代码利用这两个函数获取MessageBoxA的函数地址，使hello-2.5.exe程序原有功能正常。

**第四阶段：熟悉并修改PE文件的资源表**
- 利用PEview.exe熟悉PEview.exe程序的资源表的结构。
- 用UltraEdit修改PEview.exe，使得该文件的图标变成csWhu.ico。
- 熟悉eXeScope工具的使用，并利用该工具汉化PEview.exe程序。

**第五阶段：课后习题思考**
- 如何打造最小的PE文件：修改WHU_PE-2.5.exe文件，保持该文件的功能不变，使得该文件大小尽可能小。
- 替换程序的图标时，如果新图标比原有图标大，应该如何解决？
- 如何给一个没有图标的程序（如hello-2.5.exe），添加一个图标？

